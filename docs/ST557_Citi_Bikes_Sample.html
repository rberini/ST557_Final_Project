<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robert Berini">

<title>Final Project: Citi Bikes Sample</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dffbf54dee66fccd70f297dd55a05db1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.3/leaflet.js"></script>
<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&amp;family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Project: Citi Bikes Sample</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robert Berini </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The Citi Bike program is a bike-sharing system in New York City that allows users to rent bicycles for short trips around the city. The program has become increasingly popular since its launch in 2013, with millions of rides taken each year. In this project, we will analyze Citi Bike trip data for 2018 to gain insights into usage patterns, popular routes, and user profiles.</p>
<p>The primary operational goal is to optimize bike distribution across stations to meet demand. Bike turnover time is a critical metric for this purpose, as it indicates how frequently bikes are rented and returned at each station. By analyzing trip duration, start and end locations, and user demographics, we can identify high-demand stations and times of day, allowing for better allocation and re-balancing of bikes and improved service for users. Monthly operational reports can be found at <a href="https://citibikenyc.com/system-data/operating-reports" class="uri">https://citibikenyc.com/system-data/operating-reports</a>.</p>
<p>In 2018, Citi Bike offered two main rider types: <strong>Subscribers</strong> and <strong>Customers</strong>. Subscribers paid an annual membership fee of $169 for unlimited rides up to 45 minutes each. The overage fee for subscribers was $2.50 for each additional 15 minutes. Customers paid $3 for a single ride of 30 minutes or less, or $12 for a day pass including unlimited 30-minute rides within 24 hours. The overage fee for customers was $4 for each additional 15 minutes. Understanding the differences in usage patterns between these two groups can help inform pricing strategies and service improvements.</p>
<section id="data-source" class="level3">
<h3 class="anchored" data-anchor-id="data-source">Data Source</h3>
<p>The data for this analysis is sourced from the Citi Bike system’s public data repository (<a href="https://citibikenyc.com/system-data" class="uri">https://citibikenyc.com/system-data</a>), which provides monthly trip data in CSV format. The dataset includes information such as trip duration, start and end stations, user type (subscriber or customer), and timestamps for each trip.</p>
</section>
<section id="data-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="data-dictionary">Data Dictionary</h3>
<ul>
<li><code>tripduration</code>: Duration of the trip in seconds (numeric)</li>
<li><code>tripduration_min</code>: Duration of the trip in minutes (numeric, calculated from tripduration)</li>
<li><code>starttime</code>: Timestamp for when the trip started (datetime)</li>
<li><code>stoptime</code>: Timestamp for when the trip ended (datetime)</li>
<li><code>month</code>: Month the trip took place (ordered factor: Jan-Dec)</li>
<li><code>day_of_week</code>: Day of the week the trip started (ordered factor: Mon-Sun)</li>
<li><code>weekday_weekend</code>: Whether the trip occurred on a weekday or weekend (factor)</li>
<li><code>hour_of_day</code>: Hour of day when the trip started, 0-23 (integer)</li>
<li><code>time_of_day</code>: Time period classification (ordered factor: Morning, Late Morning, Afternoon, Evening, Night)</li>
<li><code>start_station_id</code>: Unique identifier for the starting station (character)</li>
<li><code>start_station_name</code>: Name of the starting station (character)</li>
<li><code>start_station_latitude</code>: Latitude coordinate of the starting station (numeric)</li>
<li><code>start_station_longitude</code>: Longitude coordinate of the starting station (numeric)</li>
<li><code>end_station_id</code>: Unique identifier for the ending station (character)</li>
<li><code>end_station_name</code>: Name of the ending station (character)</li>
<li><code>end_station_latitude</code>: Latitude coordinate of the ending station (numeric)</li>
<li><code>end_station_longitude</code>: Longitude coordinate of the ending station (numeric)</li>
<li><code>round_trip</code>: Whether the trip started and ended at the same station (logical: TRUE/FALSE)</li>
<li><code>bikeid</code>: Unique identifier for the bike used (character)</li>
<li><code>usertype</code>: Type of user (factor: Subscriber or Customer)</li>
<li><code>birth_year</code>: Self-reported birth year of the user (numeric)</li>
<li><code>approx_age</code>: Approximate age of the user in 2018 (numeric, calculated as 2018 - birth_year)</li>
<li><code>gender</code>: Self-reported gender of the user (factor: Male, Female, Unknown)</li>
</ul>
</section>
</section>
<section id="data-loading-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-preparation">Data Loading and Preparation</h2>
<p>Load required packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co">#for managing function name conflicts</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#for data manipulation and visualization</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co">#for data cleaning and nicer tables</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urbnthemes) <span class="co">#for urban institute chart styles</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co">#for tidying statistical test outputs</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr) <span class="co">#for enhanced data summaries</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co">#for descriptive statistics</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer) <span class="co">#for simulation-based inference</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet) <span class="co">#for interactive maps</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co">#for enhanced markdown rendering</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) <span class="co">#for enhanced table formatting</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span>filter,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span>scale_fill_discrete,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span>scale_colour_discrete,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span>scale_fill_ordinal,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span>chisq.test</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen =</span> <span class="dv">999</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">pillar.sigfig =</span> <span class="dv">10</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set_urbn_defaults</span>(<span class="at">style =</span> <span class="st">"print"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the full transformed Citi Bike 2018 data (for reference)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>citibike_2018 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/combined/citibike_2018_transformed.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load the Citi Bike 2018 data sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="ot">&lt;-</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="st">"data/sample/citibike_2018_sample_1000.rds"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(citibike_sample_2018)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 23
$ tripduration            &lt;dbl&gt; 1034, 166, 308, 926, 802, 647, 754, 344, 489, …
$ tripduration_min        &lt;dbl&gt; 17.233333, 2.766667, 5.133333, 15.433333, 13.3…
$ starttime               &lt;dttm&gt; 2018-05-01 10:42:28, 2018-11-15 09:42:47, 201…
$ stoptime                &lt;dttm&gt; 2018-05-01 10:59:42, 2018-11-15 09:45:34, 201…
$ month                   &lt;ord&gt; May, Nov, Apr, Feb, Oct, May, Mar, Jul, Aug, O…
$ day_of_week             &lt;ord&gt; Tue, Thu, Sun, Fri, Mon, Thu, Tue, Mon, Tue, S…
$ weekday_weekend         &lt;fct&gt; Weekday, Weekday, Weekend, Weekday, Weekday, W…
$ hour_of_day             &lt;int&gt; 10, 9, 10, 8, 18, 12, 13, 16, 18, 16, 20, 10, …
$ time_of_day             &lt;ord&gt; Late Morning, Late Morning, Late Morning, Morn…
$ start_station_id        &lt;chr&gt; "361", "3415", "3107", "356", "3369", "3316", …
$ start_station_name      &lt;chr&gt; "Allen St &amp; Hester St", "Prospect Pl &amp; 6 Ave",…
$ start_station_latitude  &lt;dbl&gt; 40.71606, 40.67933, 40.72312, 40.71623, 40.772…
$ start_station_longitude &lt;dbl&gt; -73.99191, -73.97520, -73.95212, -73.98261, -7…
$ end_station_id          &lt;chr&gt; "167", "353", "3106", "3489", "2022", "3172", …
$ end_station_name        &lt;chr&gt; "E 39 St &amp; 3 Ave", "S Portland Ave &amp; Hanson Pl…
$ end_station_latitude    &lt;dbl&gt; 40.74890, 40.68540, 40.72325, 40.71070, 40.759…
$ end_station_longitude   &lt;dbl&gt; -73.97605, -73.97431, -73.94308, -74.00354, -7…
$ round_trip              &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS…
$ bikeid                  &lt;chr&gt; "30037", "28431", "20049", "17765", "34334", "…
$ usertype                &lt;fct&gt; Subscriber, Subscriber, Subscriber, Subscriber…
$ birth_year              &lt;dbl&gt; 1985, 1991, 1975, 1994, 1993, 1968, 1981, 1961…
$ approx_age              &lt;dbl&gt; 33, 27, 43, 24, 25, 50, 37, 57, 30, 32, 27, 35…
$ gender                  &lt;fct&gt; Male, Male, Male, Female, Female, Male, Male, …</code></pre>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">Summary statistics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  tripduration     tripduration_min    starttime                  
 Min.   :   61.0   Min.   :  1.017   Min.   :2018-01-02 13:48:28  
 1st Qu.:  336.8   1st Qu.:  5.612   1st Qu.:2018-05-01 18:20:57  
 Median :  553.0   Median :  9.217   Median :2018-07-20 13:34:32  
 Mean   :  748.6   Mean   : 12.477   Mean   :2018-07-14 12:57:25  
 3rd Qu.:  900.5   3rd Qu.: 15.008   3rd Qu.:2018-09-28 13:17:00  
 Max.   :26751.0   Max.   :445.850   Max.   :2018-12-31 11:22:22  
                                                                  
    stoptime                       month     day_of_week weekday_weekend
 Min.   :2018-01-02 14:00:20   Jun    :109   Sun:110     Weekday:771    
 1st Qu.:2018-05-01 18:59:39   Sep    :108   Mon:141     Weekend:229    
 Median :2018-07-20 13:37:57   Jul    :104   Tue:158                    
 Mean   :2018-07-14 13:09:54   Aug    :104   Wed:157                    
 3rd Qu.:2018-09-28 13:34:09   Oct    : 96   Thu:158                    
 Max.   :2018-12-31 11:23:55   May    : 88   Fri:157                    
                               (Other):391   Sat:119                    
  hour_of_day          time_of_day  start_station_id   start_station_name
 Min.   : 0.00   Morning     :175   Length:1000        Length:1000       
 1st Qu.:10.00   Late Morning:139   Class :character   Class :character  
 Median :15.00   Afternoon   :298   Mode  :character   Mode  :character  
 Mean   :13.99   Evening     :294                                        
 3rd Qu.:18.00   Night       : 94                                        
 Max.   :23.00                                                           
                                                                         
 start_station_latitude start_station_longitude end_station_id    
 Min.   :40.66          Min.   :-74.02          Length:1000       
 1st Qu.:40.72          1st Qu.:-73.99          Class :character  
 Median :40.74          Median :-73.99          Mode  :character  
 Mean   :40.74          Mean   :-73.98                            
 3rd Qu.:40.76          3rd Qu.:-73.97                            
 Max.   :40.81          Max.   :-73.91                            
                                                                  
 end_station_name   end_station_latitude end_station_longitude round_trip     
 Length:1000        Min.   :40.66        Min.   :-74.02        Mode :logical  
 Class :character   1st Qu.:40.72        1st Qu.:-73.99        FALSE:985      
 Mode  :character   Median :40.74        Median :-73.99        TRUE :15       
                    Mean   :40.74        Mean   :-73.98                       
                    3rd Qu.:40.76        3rd Qu.:-73.97                       
                    Max.   :40.81        Max.   :-73.91                       
                                                                              
    bikeid                usertype     birth_year     approx_age   
 Length:1000        Subscriber:955   Min.   :1941   Min.   :17.00  
 Class :character   Customer  : 45   1st Qu.:1971   1st Qu.:28.00  
 Mode  :character                    Median :1983   Median :35.00  
                                     Mean   :1980   Mean   :38.04  
                                     3rd Qu.:1990   3rd Qu.:47.00  
                                     Max.   :2001   Max.   :77.00  
                                                                   
     gender   
 Unknown:  0  
 Male   :763  
 Female :237  
              
              
              
              </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">citibike_sample_2018</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">1000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">logical</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">start_station_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">458</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">start_station_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">457</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">end_station_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">457</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">end_station_name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">456</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bikeid</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">956</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">Jun: 109, Sep: 108, Jul: 104, Aug: 104</td>
</tr>
<tr class="even">
<td style="text-align: left;">day_of_week</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Tue: 158, Thu: 158, Wed: 157, Fri: 157</td>
</tr>
<tr class="odd">
<td style="text-align: left;">weekday_weekend</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Wee: 771, Wee: 229</td>
</tr>
<tr class="even">
<td style="text-align: left;">time_of_day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Aft: 298, Eve: 294, Mor: 175, Lat: 139</td>
</tr>
<tr class="odd">
<td style="text-align: left;">usertype</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Sub: 955, Cus: 45</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Mal: 763, Fem: 237, Unk: 0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: logical</strong></p>
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: left;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">round_trip</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">FAL: 985, TRU: 15</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 21%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tripduration</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">748.61</td>
<td style="text-align: right;">1042.63</td>
<td style="text-align: right;">61.00</td>
<td style="text-align: right;">336.75</td>
<td style="text-align: right;">553.00</td>
<td style="text-align: right;">900.50</td>
<td style="text-align: right;">26751.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">tripduration_min</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.48</td>
<td style="text-align: right;">17.38</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">5.61</td>
<td style="text-align: right;">9.22</td>
<td style="text-align: right;">15.01</td>
<td style="text-align: right;">445.85</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hour_of_day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.99</td>
<td style="text-align: right;">4.91</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: left;">▁▅▃▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">start_station_latitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40.74</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">40.66</td>
<td style="text-align: right;">40.72</td>
<td style="text-align: right;">40.74</td>
<td style="text-align: right;">40.76</td>
<td style="text-align: right;">40.81</td>
<td style="text-align: left;">▂▃▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">start_station_longitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-73.98</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-74.02</td>
<td style="text-align: right;">-73.99</td>
<td style="text-align: right;">-73.99</td>
<td style="text-align: right;">-73.97</td>
<td style="text-align: right;">-73.91</td>
<td style="text-align: left;">▃▇▃▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">end_station_latitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">40.74</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">40.66</td>
<td style="text-align: right;">40.72</td>
<td style="text-align: right;">40.74</td>
<td style="text-align: right;">40.76</td>
<td style="text-align: right;">40.81</td>
<td style="text-align: left;">▂▃▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">end_station_longitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-73.98</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-74.02</td>
<td style="text-align: right;">-73.99</td>
<td style="text-align: right;">-73.99</td>
<td style="text-align: right;">-73.97</td>
<td style="text-align: right;">-73.91</td>
<td style="text-align: left;">▃▇▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">birth_year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1979.96</td>
<td style="text-align: right;">12.01</td>
<td style="text-align: right;">1941.00</td>
<td style="text-align: right;">1971.00</td>
<td style="text-align: right;">1983.00</td>
<td style="text-align: right;">1990.00</td>
<td style="text-align: right;">2001.00</td>
<td style="text-align: left;">▁▃▅▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">approx_age</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">38.04</td>
<td style="text-align: right;">12.01</td>
<td style="text-align: right;">17.00</td>
<td style="text-align: right;">28.00</td>
<td style="text-align: right;">35.00</td>
<td style="text-align: right;">47.00</td>
<td style="text-align: right;">77.00</td>
<td style="text-align: left;">▇▇▅▃▁</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">starttime</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2018-01-02 13:48:28</td>
<td style="text-align: left;">2018-12-31 11:22:22</td>
<td style="text-align: left;">2018-07-20 13:34:32</td>
<td style="text-align: right;">1000</td>
</tr>
<tr class="even">
<td style="text-align: left;">stoptime</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2018-01-02 14:00:20</td>
<td style="text-align: left;">2018-12-31 11:23:55</td>
<td style="text-align: left;">2018-07-20 13:37:57</td>
<td style="text-align: right;">1000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(tripduration_min, approx_age)) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">describeBy</span>(<span class="at">group =</span> citibike_sample_2018<span class="sc">$</span>usertype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
group: Subscriber
                 vars   n  mean    sd median trimmed   mad   min    max range
tripduration_min    1 955 11.49  9.24   8.95   10.08  6.45  1.02 119.32 118.3
approx_age          2 955 38.17 12.01  35.00   37.18 11.86 17.00  77.00  60.0
                 skew kurtosis   se
tripduration_min 3.27    24.39 0.30
approx_age       0.68    -0.36 0.39
------------------------------------------------------------ 
group: Customer
                 vars  n  mean    sd median trimmed   mad  min    max  range
tripduration_min    1 45 33.51 67.32  17.78   20.14 11.44  5.9 445.85 439.95
approx_age          2 45 35.38 11.90  31.00   34.32  8.90 17.0  65.00  48.00
                 skew kurtosis    se
tripduration_min 5.20    28.47 10.04
approx_age       0.81    -0.38  1.77</code></pre>
</div>
</div>
</section>
<section id="trip-duration-analysis" class="level3">
<h3 class="anchored" data-anchor-id="trip-duration-analysis">Trip duration analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">describe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 vars    n  mean    sd median trimmed  mad  min    max  range
tripduration_min    1 1000 12.48 17.38   9.22   10.41 6.52 1.02 445.85 444.83
                  skew kurtosis   se
tripduration_min 16.52   389.84 0.55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tripduration_min)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Trip Duration"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Trip Duration (minutes)"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_axis</span>(<span class="at">axis =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_ticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tripduration_min)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Trip Duration"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Trip Duration (minutes)"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_axis</span>(<span class="at">axis =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_ticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bootstrap-confidence-interval-for-mean-trip-duration" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-confidence-interval-for-mean-trip-duration">Bootstrap confidence interval for mean trip duration</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fu">nrow</span>(citibike_sample_2018), <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.56418</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>boot_dist_1 <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_dist_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response: tripduration_min (numeric)
# A tibble: 1 × 1
         stat
        &lt;dbl&gt;
1 12.56418333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>boot_dist_1 <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">"#1696d2"</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>, <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap Mean Trip Duration"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"images/citibike_boot_1.png"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>boot_dist_10 <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_dist_10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response: tripduration_min (numeric)
# A tibble: 10 × 2
   replicate        stat
       &lt;int&gt;       &lt;dbl&gt;
 1         1 12.56418333
 2         2 12.6653    
 3         3 12.63868333
 4         4 12.27995   
 5         5 13.2369    
 6         6 12.38261667
 7         7 12.23016667
 8         8 11.41803333
 9         9 12.26963333
10        10 12.17411667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>boot_dist_10 <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">"#1696d2"</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>, <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap Mean Trip Duration"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"images/citibike_boot_10.png"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>boot_dist_1000 <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"mean"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>boot_dist_1000 <span class="sc">|&gt;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> stat)) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">dotsize =</span> .<span class="dv">45</span>, <span class="at">fill =</span> <span class="st">"#1696d2"</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>, <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap Mean Trip Duration"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"images/citibike_boot_1000.png"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> boot_dist_1000 <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">"percentile"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
     lower_ci    upper_ci
        &lt;dbl&gt;       &lt;dbl&gt;
1 11.53287042 13.66787833</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>boot_dist_1000 <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>(<span class="at">bins =</span> <span class="dv">100</span>, <span class="at">fill =</span> <span class="st">"#1696d2"</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> boot_ci, <span class="at">fill =</span> <span class="st">"#fdbf11"</span>, <span class="at">color =</span> <span class="st">"#fdbf11"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">10</span>, <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap Mean Trip Duration"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"images/citibike_boot_ci.png"</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mathematical-confidence-interval-for-mean-trip-duration" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-confidence-interval-for-mean-trip-duration">Mathematical confidence interval for mean trip duration</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  estimate   statistic         p.value parameter    conf.low   conf.high method 
     &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1 12.47675 22.70511189 2.347020611e-92       999 11.39841822 13.55508178 One Sa…
# ℹ 1 more variable: alternative &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="comparison-of-bootstrap-and-mathematical-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-bootstrap-and-mathematical-confidence-intervals">Comparison of bootstrap and mathematical confidence intervals</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(citibike_2018<span class="sc">$</span>tripduration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_dist_1000<span class="sc">$</span>stat)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>t_result <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>ci_table <span class="ot">&lt;-</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Population (True)"</span>, <span class="st">"Bootstrap"</span>, <span class="st">"T-test"</span>),</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">c</span>(pop_mean, boot_mean, t_result<span class="sc">$</span>estimate),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_CI =</span> <span class="fu">c</span>(<span class="cn">NA</span>, boot_ci<span class="sc">$</span>lower_ci, t_result<span class="sc">$</span>conf.low),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_CI =</span> <span class="fu">c</span>(<span class="cn">NA</span>, boot_ci<span class="sc">$</span>upper_ci, t_result<span class="sc">$</span>conf.high)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">font_size =</span> <span class="dv">14</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">html_font =</span> <span class="st">"Lato"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>ci_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lower_CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Upper_CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Population (True)</td>
<td style="text-align: right;">13.2123</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bootstrap</td>
<td style="text-align: right;">12.4657</td>
<td style="text-align: right;">11.5329</td>
<td style="text-align: right;">13.6679</td>
</tr>
<tr class="odd">
<td style="text-align: left;">T-test</td>
<td style="text-align: right;">12.4767</td>
<td style="text-align: right;">11.3984</td>
<td style="text-align: right;">13.5551</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="bivariate-analysis-trip-duration-by-weekday-vs.-weekend" class="level3">
<h3 class="anchored" data-anchor-id="bivariate-analysis-trip-duration-by-weekday-vs.-weekend">Bivariate analysis: Trip duration by weekday vs.&nbsp;weekend</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tripduration_min, <span class="at">fill =</span> weekday_weekend)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Trip Durations by Week Part"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Trip Duration (minutes)"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Week Part"</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_axis</span>(<span class="at">axis =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_ticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weekday_weekend, <span class="at">y =</span> tripduration_min, <span class="at">fill =</span> weekday_weekend)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">23</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#db2b27"</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trip Duration Distribution by Week Part"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Trip Duration (minutes)"</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="randomization-test-mean-trip-duration-on-weekdays-vs.-weekends" class="level3">
<h3 class="anchored" data-anchor-id="randomization-test-mean-trip-duration-on-weekdays-vs.-weekends">Randomization test: Mean trip duration on weekdays vs.&nbsp;weekends</h3>
<p>Calculate observed difference in means</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>obs_diff <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(tripduration_min <span class="sc">~</span> weekday_weekend) <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in means"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Weekend"</span>, <span class="st">"Weekday"</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>obs_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response: tripduration_min (numeric)
Explanatory: weekday_weekend (factor)
# A tibble: 1 × 1
         stat
        &lt;dbl&gt;
1 2.181183533</code></pre>
</div>
</div>
<p>Generate null distribution through permutation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(tripduration_min <span class="sc">~</span> weekday_weekend) <span class="sc">|&gt;</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in means"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Weekend"</span>, <span class="st">"Weekday"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize null distribution with observed statistic</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_diff<span class="sc">$</span>stat, <span class="at">direction =</span> <span class="st">"two_sided"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Null Distribution of Mean Trip Duration Difference"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference in Mean Trip Duration (Weekend - Weekday)"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_axis</span>(<span class="at">axis =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_ticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff<span class="sc">$</span>stat, <span class="at">direction =</span> <span class="st">"two-sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.156</code></pre>
</div>
</div>
</section>
<section id="mathematical-two-sample-t-test-mean-trip-duration-on-weekdays-vs.-weekends" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-two-sample-t-test-mean-trip-duration-on-weekdays-vs.-weekends">Mathematical two-sample t-test: Mean trip duration on weekdays vs.&nbsp;weekends</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday_weekend =</span> <span class="fu">fct_relevel</span>(weekday_weekend, <span class="st">"Weekend"</span>, <span class="st">"Weekday"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  (\(x) <span class="fu">t.test</span>(tripduration_min <span class="sc">~</span> weekday_weekend, <span class="at">data =</span> x, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))() <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
     estimate   estimate1   estimate2   statistic      p.value   parameter
        &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 2.181183533 14.15844250 11.97725897 1.047047861 0.2961176552 243.0440771
# ℹ 4 more variables: conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;, method &lt;chr&gt;,
#   alternative &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="comparison-of-randomization-test-and-t-test-results" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-randomization-test-and-t-test-results">Comparison of randomization test and t-test results</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>true_diff <span class="ot">&lt;-</span> citibike_2018 <span class="sc">|&gt;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(weekday_weekend) <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_duration =</span> <span class="fu">mean</span>(tripduration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">diff =</span> <span class="fu">diff</span>(mean_duration)) <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(diff)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>randomization_result <span class="ot">&lt;-</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  null_distribution <span class="sc">|&gt;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff<span class="sc">$</span>stat, <span class="at">direction =</span> <span class="st">"two-sided"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p_value)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>t_test_result <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday_weekend =</span> <span class="fu">fct_relevel</span>(weekday_weekend, <span class="st">"Weekend"</span>, <span class="st">"Weekday"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  (\(x) <span class="fu">t.test</span>(tripduration_min <span class="sc">~</span> weekday_weekend, <span class="at">data =</span> x, <span class="at">var.equal =</span> <span class="cn">FALSE</span>))() <span class="sc">|&gt;</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Population (True)"</span>, <span class="st">"Randomization Test"</span>, <span class="st">"T-test"</span>),</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">c</span>(</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    true_diff,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    obs_diff<span class="sc">$</span>stat,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    t_test_result<span class="sc">$</span>estimate</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    randomization_result,</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>    t_test_result<span class="sc">$</span>p.value</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Method              Difference       P_Value
  &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;
1 Population (True)  1.750170423 NA           
2 Randomization Test 2.181183533  0.156       
3 T-test             2.181183533  0.2961176552</code></pre>
</div>
</div>
</section>
<section id="bivariate-analysis-trip-duration-by-user-type" class="level3">
<h3 class="anchored" data-anchor-id="bivariate-analysis-trip-duration-by-user-type">Bivariate analysis: Trip duration by user type</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tripduration_min, <span class="at">fill =</span> usertype)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Trip Durations by User Type"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Trip Duration (minutes)"</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"User Type"</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_axis</span>(<span class="at">axis =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_ticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> usertype, <span class="at">y =</span> tripduration_min, <span class="at">fill =</span> usertype)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">23</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#db2b27"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trip Duration Distribution by Usertype"</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Trip Duration (minutes)"</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(usertype) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_duration =</span> <span class="fu">median</span>(tripduration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> usertype, <span class="at">y =</span> median_duration, <span class="at">fill =</span> usertype)) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Median Trip Duration by User Type"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Median Trip Duration (minutes)"</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>obs_diff_median <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(tripduration_min <span class="sc">~</span> usertype) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in medians"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Customer"</span>, <span class="st">"Subscriber"</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>obs_diff_median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response: tripduration_min (numeric)
Explanatory: usertype (factor)
# A tibble: 1 × 1
         stat
        &lt;dbl&gt;
1 8.833333333</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">557</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>null_distribution_median <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(tripduration_min <span class="sc">~</span> usertype) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"diff in medians"</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"Customer"</span>, <span class="st">"Subscriber"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>null_distribution_median <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_diff_median, <span class="at">direction =</span> <span class="st">"two-sided"</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Null Distribution of Difference in Median Trip Duration"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Difference in Median Duration (minutes)"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>null_distribution_median <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff_median, <span class="at">direction =</span> <span class="st">"two-sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(tripduration_min <span class="sc">~</span> usertype,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> citibike_sample_2018,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic        p.value method                                    alternative
      &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                                     &lt;chr&gt;      
1    9961.5 1.148162973e-9 Wilcoxon rank sum test with continuity c… two.sided  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>true_diff_median <span class="ot">&lt;-</span> citibike_2018 <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(usertype) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_duration =</span> <span class="fu">median</span>(tripduration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">diff =</span> <span class="fu">diff</span>(median_duration)) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(diff)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>randomization_result_median <span class="ot">&lt;-</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  null_distribution_median <span class="sc">|&gt;</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff_median, <span class="at">direction =</span> <span class="st">"two-sided"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p_value)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>wilcox_result <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(tripduration_min <span class="sc">~</span> usertype,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> citibike_sample_2018,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">exact =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Population (True)"</span>, <span class="st">"Randomization Test"</span>, <span class="st">"Wilcoxon Test"</span>),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> <span class="fu">c</span>(</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    true_diff_median,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    obs_diff_median<span class="sc">$</span>stat,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    obs_diff_median<span class="sc">$</span>stat  <span class="co"># Same observed difference</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span>,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    randomization_result_median,</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>    wilcox_result<span class="sc">$</span>p.value</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Method               Difference         P_Value
  &lt;chr&gt;                     &lt;dbl&gt;           &lt;dbl&gt;
1 Population (True)  11           NA             
2 Randomization Test  8.833333333  0             
3 Wilcoxon Test       8.833333333  1.148162973e-9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_of_day, <span class="at">y =</span> tripduration_min, <span class="at">fill =</span> time_of_day)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> mean, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">23</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"#db2b27"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#000000"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trip Duration Distribution by Time of Day"</span>,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Trip Duration (minutes)"</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(tripduration_min <span class="sc">~</span> time_of_day, <span class="at">data =</span> citibike_sample_2018) <span class="sc">|&gt;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  term           df         sumsq      meansq    statistic       p.value
  &lt;chr&gt;       &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 time_of_day     4   2193.874083 548.4685206  1.822315809  0.1222903112
2 Residuals     995 299468.4979   300.9733647 NA           NA           </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(hour_of_day, usertype) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hour_of_day, <span class="at">y =</span> n, <span class="at">color =</span> usertype)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">group_by</span>(.x, usertype) <span class="sc">|&gt;</span> <span class="fu">filter</span>(hour_of_day <span class="sc">==</span> <span class="fu">max</span>(hour_of_day)),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> usertype),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.size =</span> <span class="dv">0</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"lines"</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="at">by =</span> <span class="dv">6</span>),</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.15</span>))</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trip Volume by Hour and User Type"</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Hour of Day"</span>, <span class="at">y =</span> <span class="st">"Number of Trips"</span>) <span class="sc">+</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"images/citibike_hour_user.png"</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(day_of_week, usertype) <span class="sc">|&gt;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day_of_week, <span class="at">y =</span> n, <span class="at">color =</span> usertype, <span class="at">group =</span> usertype)) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">group_by</span>(.x, usertype) <span class="sc">|&gt;</span> <span class="fu">filter</span>(day_of_week <span class="sc">==</span> <span class="fu">max</span>(day_of_week)),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> usertype),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.size =</span> <span class="dv">0</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"lines"</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.15</span>))</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trip Volume by Day of Week and User Type"</span>,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Day of Week"</span>, <span class="at">y =</span> <span class="st">"Number of Trips"</span>) <span class="sc">+</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(month, usertype) <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> n, <span class="at">color =</span> usertype, <span class="at">group =</span> usertype)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="sc">~</span><span class="fu">group_by</span>(.x, usertype) <span class="sc">|&gt;</span> <span class="fu">filter</span>(month <span class="sc">==</span> <span class="fu">max</span>(month)),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> usertype),</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.size =</span> <span class="dv">0</span>,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"lines"</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.15</span>))</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trip Volume by Month and User Type"</span>,</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Number of Trips"</span>) <span class="sc">+</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> approx_age, <span class="at">y =</span> tripduration_min)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trip Duration by Age"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Trip Duration (minutes)"</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter_grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tripduration_min <span class="sc">&lt;=</span> <span class="dv">60</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> approx_age, <span class="at">y =</span> tripduration_min)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Trip Duration by Age (trips ≤ 60 minutes)"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (years)"</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Trip Duration (minutes)"</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scatter_grid</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(citibike_sample_2018<span class="sc">$</span>approx_age, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>         citibike_sample_2018<span class="sc">$</span>tripduration_min) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
         estimate       statistic      p.value parameter        conf.low
            &lt;dbl&gt;           &lt;dbl&gt;        &lt;dbl&gt;     &lt;int&gt;           &lt;dbl&gt;
1 -2.864812463e-3 -9.050305726e-2 0.9279056248       998 -6.484637832e-2
# ℹ 3 more variables: conf.high &lt;dbl&gt;, method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(usertype, gender) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">mean</span>(approx_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_age =</span> <span class="fu">median</span>(approx_age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  usertype   gender     n    mean_age median_age
  &lt;fct&gt;      &lt;fct&gt;  &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;
1 Subscriber Male     738 38.61382114         36
2 Subscriber Female   217 36.64055300         33
3 Customer   Male      25 37.04               33
4 Customer   Female    20 33.3                30</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(citibike_sample_2018<span class="sc">$</span>usertype, citibike_sample_2018<span class="sc">$</span>gender) <span class="sc">|&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
    statistic        p.value parameter method                                   
        &lt;dbl&gt;          &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                                    
1 10.04440784 1.528111163e-3         1 Pearson's Chi-squared test with Yates' c…</code></pre>
</div>
</div>
</section>
<section id="popular-start-stations" class="level3">
<h3 class="anchored" data-anchor-id="popular-start-stations">Popular start stations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(start_station_name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(start_station_name, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Most Popular Start Stations"</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of Trips"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="map-of-start-stations-by-trip-volume" class="level3">
<h3 class="anchored" data-anchor-id="map-of-start-stations-by-trip-volume">Map of start stations by trip volume</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>station_counts <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(start_station_name, start_station_latitude, start_station_longitude) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_station =</span> <span class="fu">if_else</span>(<span class="fu">rank</span>(<span class="fu">desc</span>(n)) <span class="sc">&lt;=</span> <span class="dv">10</span>, <span class="st">"Top 10"</span>, <span class="st">"Other"</span>),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">if_else</span>(top_station <span class="sc">==</span> <span class="st">"Top 10"</span>, <span class="st">"#0a4c6a"</span>, <span class="st">"#ca5800"</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(top_station)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(station_counts) <span class="sc">|&gt;</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">|&gt;</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>start_station_longitude,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="sc">~</span>start_station_latitude,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span>(n<span class="sc">^</span><span class="fl">1.5</span>) <span class="sc">*</span> <span class="fl">0.5</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(start_station_name, <span class="st">"&lt;br&gt;Trips: "</span>, n),</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>color,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span>color,</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="cn">TRUE</span>,</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">1</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span>,</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#0a4c6a"</span>, <span class="st">"#ca5800"</span>),</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Top 10"</span>, <span class="st">"Other"</span>),</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Start Station Volume"</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-220db4c9b4e2a3f9a513" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-220db4c9b4e2a3f9a513">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.73221853,40.74144387,40.75001986,40.7612274,40.76500525,40.77140426,40.6686273,40.6662078,40.751396,40.76030096,40.771522,40.76087502,40.666287,40.7892105,40.74290902,40.7839636,40.7659,40.75325964,40.774591,40.7527085,40.76408932350688,40.7525758,40.751047,40.6750705,40.668132,40.7658346,40.7747878,40.761584,40.756913,40.76315481910373,40.7701477,40.6705135,40.748,40.74718234,40.74731,40.6728155,40.766368,40.77282817,40.77632142182271,40.78307,40.7857851,40.72243797,40.7252556952547,40.74901271,40.6704922,40.7505853470215,40.751551,40.76370739,40.7454973,40.74937024193277,40.76019252,40.69308257,40.72019576,40.722055,40.7746671,40.77966809007312,40.78524672,40.7767,40.69165183,40.72580614,40.72082834,40.72368361,40.6795766,40.73652889,40.7361967,40.73172428,40.71602118,40.676368,40.72311651,40.6867443,40.6765304,40.67514683870979,40.71622644,40.70538077,40.68962188790333,40.7668,40.70463334,40.71044554,40.73454567,40.8143256,40.70924826276157,40.74286877312112,40.7462009,40.74854862,40.75172632,40.75299641,40.75513557,40.76068327096592,40.76228826,40.76344058,40.7652654,40.76695317,40.76915505,40.7016657,40.701907,40.71247661,40.69991755,40.69383,40.68488,40.71427487,40.697787,40.73038599,40.6830456,40.804213,40.71117444,40.799484,40.76590936,40.79127,40.79406660818552,40.7734066,40.77579376683666,40.77896784,40.71273266,40.71494807,40.73291553,40.69760127,40.68764484,40.69573398,40.72210378668603,40.70831794366396,40.693261,40.71559509,40.69239502,40.696192,40.6859296,40.7770575,40.7919557,40.72951496224949,40.6902375,40.7633589,40.6906495,40.68940747,40.68312489,40.67759206937376,40.68199044270703,40.6829151,40.71335226222875,40.78145,40.71413089,40.6802133,40.6792788,40.72179134,40.71748752,40.73331967,40.7869946,40.7904828,40.7903051,40.72953837,40.73047309,40.73261787,40.7961535,40.7989445,40.796879,40.8014866,40.73223272,40.8029263,40.72955361,40.72966729392978,40.734232,40.73726186,40.73536705560539,40.73704984,40.73624527,40.72502876,40.72307749068673,40.72217444,40.7208736,40.73587678,40.73314259,40.73827428,40.736502,40.74096374,40.7381765,40.73912601,40.739445,40.74444921,40.74394314,40.7457121,40.74322681432173,40.74765947,40.746524,40.74780373,40.7489006,40.75272201381188,40.75216528062197,40.75412081077926,40.75118387463277,40.75255434,40.75323098,40.75510267,40.7546011026,40.75724567911726,40.72686951528207,40.72299208,40.75714758,40.756014,40.75763227739443,40.7597108,40.75797322,40.75899655960512,40.75968085,40.75892386377695,40.76095756,40.76302594280519,40.76350532,40.72453734,40.72228087,40.759107,40.76471851944339,40.72621788,40.77118287540658,40.76663814,40.7689738,40.77112927,40.77224853772174,40.7727966,40.77573034,40.77677702,40.7728384,40.7724607,40.77565541,40.77801203,40.77536905,40.778301,40.7779453,40.72521311,40.78112229934166,40.7835016,40.78245417527987,40.7849032,40.787801,40.77518615,40.6707767,40.744219,40.71893904,40.7158155,40.71911552,40.801694,40.805159,40.70530954,40.69241829257847,40.711066,40.68223166,40.6794268,40.70955958,40.73944820130403,40.715143,40.711863,40.71929301,40.7169811,40.7643971,40.718822,40.72165481,40.71286844,40.72743423,40.73026,40.735238,40.728846,40.68506807308177,40.69089272,40.6725058,40.6847514,40.714215,40.69512845,40.71167351,40.71910537,40.6843549,40.71625008,40.70140317257725,40.70862144,40.72036775298455,40.7076449441757,40.72917025,40.68691865,40.68851534,40.73020660529954,40.72430527250332,40.7987859,40.8025566,40.8107922,40.70583339,40.717571,40.7103685423523,40.6814598,40.805726,40.74025878,40.74311555376486,40.76440023,40.70905623,40.71939226,40.70569254,40.70411791,40.72710258,40.73226398,40.6809833854,40.7781314,40.78948541553215,40.71269042,40.6900815,40.71076228,40.73555,40.72706363348306,40.72362738,40.72708584,40.71413311,40.72906,40.6845683,40.686203,40.81,40.72317958,40.71485150526251,40.7149787,40.69327018,40.724055,40.71745169,40.71774592,40.7172274,40.70277159,40.6853761,40.8045555,40.69608941,40.6741806,40.6767,40.7047177,40.707873,40.73535398,40.751581,40.7277140777778,40.71173107,40.6777748,40.679043,40.6750207,40.7949879,40.6828003,40.66514681533792,40.6793307,40.6769694,40.68402,40.75110165,40.71450451,40.77750702754798,40.78414472,40.78720869,40.72110063,40.71850211,40.71469,40.71260486,40.71285887,40.710451,40.6746957,40.711512,40.70355377,40.70122128,40.71307916,40.71117416,40.6737236,40.72779126,40.7284186,40.809725,40.70877084,40.72229346,40.68926942,40.672695,40.73047747,40.69957608,40.6740123,40.73492695,40.73143724085228,40.7449067,40.74232744,40.7153379,40.7973721,40.795,40.79904139288298,40.7989937,40.8008363,40.7981856,40.7997568,40.802692,40.73781509,40.73997354103409,40.73935542,40.74102150900266,40.74334935,40.74294891660091,40.73971301,40.7435337324616,40.746745,40.74238787,40.74345335,40.74691959,40.74487634,40.74395411,40.74734825,40.75018156325683,40.746647,40.749156,40.75019995,40.75594159,40.75462324029105,40.75660359,40.75038009,40.75466591,40.73401143,40.75640548,40.7575699,40.75898481399634,40.76009437,40.75527307,40.75500254,40.7568001,40.75668720603179,40.75929124,40.76341379,40.76269882,40.76227205,40.76360467795863,40.76727216,40.75992262,40.76132983124814,40.76669671,40.76584941,40.76309387270797,40.768254,40.770513,40.77163851,40.77452835,40.77492513,40.7785669,40.78339981,40.7867947,40.78499979,40.78839,40.79025417330419,40.7882213,40.7921,40.7937704,40.72494672359416,40.69610226,40.6917823,40.73224119,40.72903917,40.739323,40.70255065,40.72405549,40.6610633719006,40.7941654,40.70834698,40.70717936,40.69425403,40.69196566,40.71605866,40.7403432,40.72740794,40.751873,40.74173969,40.74475148,40.71754834],[-73.98165557,-73.97536082000001,-73.96905301,-73.96094022,-73.95818491,-73.9535166,-73.98700053,-73.98199886,-74.00522599999999,-73.99884222,-73.99054099999999,-74.00277668,-73.98895053,-73.94370784,-73.97706058,-73.9471673,-73.930819,-73.94335787999999,-73.918544,-73.9397405,-73.91065120697021,-73.9364281,-73.93797000000001,-73.98775225999999,-73.97363831,-73.9265474,-73.91255510000001,-73.925921,-73.921631,-73.93985509872437,-73.91209379999999,-73.98876584999999,-73.94609269999999,-73.9432635,-73.95451,-73.98352355,-73.971518,-73.96685275999999,-73.96427392959595,-73.95939,-73.957481,-74.00566443,-74.00412082672119,-73.98848395,-73.98541675,-73.9946848154068,-73.993934,-73.9851615,-74.00197138999999,-73.99923384189606,-73.9912551,-73.97178913,-73.98997824999999,-73.98911099999999,-73.98470567,-73.98093044757842,-73.97667321,-73.92763100000001,-73.99997860000001,-73.97422494,-73.97793172,-73.97574813,-73.97854971,-74.00618025999999,-74.00859207000001,-74.00674436,-73.99974372,-73.952918,-73.95212324000001,-73.99063168000001,-73.97846878999999,-73.97523209452629,-73.98261205999999,-73.94976518999999,-73.98304268717766,-73.9347774,-74.01361706,-73.96525063,-73.99074142000001,-73.9590255,-73.96063148975372,-73.98918628692627,-73.98855723,-73.98808416,-73.98753523000001,-73.98721619,-73.98658032,-73.9845272898674,-73.98336183000001,-73.98268129,-73.98192338,-73.98169333,-73.98191841000001,-73.9437303,-74.013942,-73.94100005,-73.98971773,-73.990539,-73.96304000000001,-73.98990025000001,-73.973736,-74.00214988,-74.00348559,-73.96699104,-73.99682618999999,-73.955613,-73.97634151,-73.964839,-73.96286845207214,-73.97782542,-73.9762057363987,-73.97374737,-74.0046073,-74.00234482,-74.00711384,-73.99344558999999,-73.96968902,-73.97129667999999,-73.99724900722504,-74.00504082441329,-73.968896,-73.98702950000001,-73.99337909,-73.991218,-74.00242364,-73.97898475,-73.968087,-73.99075269699097,-73.99203074,-73.92864710000001,-73.95643106999999,-73.96885458,-73.97895137,-73.95563721656799,-73.99079024791718,-73.99318208,-73.9491033554077,-73.9183302,-73.99704680000001,-73.98432695,-73.98154004,-73.9504154,-74.0104554,-73.99510132,-73.94164802,-73.95033067999999,-73.94755757,-73.98426726,-73.98672378000001,-73.99158043,-73.94782145000001,-73.944846,-73.93726100000001,-73.9442507,-73.98889957,-73.9379,-73.98057249,-73.98067966103554,-73.986923,-73.99238966999999,-73.98797392845154,-73.99009296,-73.98473765,-73.99069656,-73.98583620786667,-73.98368779,-73.98085795,-73.98205027,-73.97573881,-73.98751968000001,-73.97809472,-73.98602212999999,-73.97738662,-73.97973776000001,-73.976806,-73.98303529,-73.97966069,-73.98194829000001,-73.97449783980846,-73.98490707000001,-73.977885,-73.9734419,-73.97604882,-73.98123621940613,-73.97992193698882,-73.98025184869766,-73.97138714790344,-73.97282625,-73.97032517,-73.97498696,-73.971878855,-73.97805914282799,-73.98919031023979,-73.97995466,-73.97207836,-73.967416,-73.96930575370789,-73.97402311,-73.96603308,-73.96865397691727,-73.97031366,-73.96226227283478,-73.96724467,-73.97209525108337,-73.97109243,-73.98185424,-73.97668709,-73.95922299999999,-73.96222069859505,-73.98379855,-73.96409422159195,-73.95348296,-73.95482273,-73.95772297000001,-73.95842134952545,-73.95577801,-73.9567526,-73.9590097,-73.94989233,-73.9468208,-73.95068615,-73.95407149,-73.94803392,-73.94881340000001,-73.94604099999999,-73.97768752,-73.94965589046478,-73.955327,-73.94891962409019,-73.950503,-73.953559,-73.94446053999999,-73.9576801,-73.97121214000001,-73.99266288,-73.99422366,-74.00666661,-73.957145,-73.95469199999999,-74.00612572,-73.98949474096298,-74.00944699999999,-73.9614583,-73.92989110000001,-74.00653609,-74.00507032871246,-73.944507,-73.944024,-73.94500379,-73.94485917999999,-73.97371465000001,-73.99596,-74.00234737,-73.95698118999999,-73.99379025,-73.95394,-74.000271,-74.008591,-73.97790759801863,-73.99612349,-74.00494695,-73.99917254,-73.981346,-73.99595065,-73.95141312,-73.99973337,-73.98901629,-74.00910589999999,-73.98672670125961,-74.00722156,-73.96165072917938,-73.96841526031494,-73.99810230999999,-73.976682,-73.9647628,-73.99102628231049,-73.99600982666016,-73.95229999999999,-73.9490782,-73.9430681,-73.94644578,-74.005549,-73.94705951213837,-73.93490300000001,-73.936322,-73.98409214,-73.98215353488922,-73.96648977,-74.01043382,-74.00247213999999,-74.01677685,-73.94818595,-74.00297088000001,-73.99852205000001,-73.95004797590001,-73.96069399,-73.95242929458618,-73.98776323,-73.94791499999999,-73.99400398,-73.95283999999999,-73.99662137031554,-73.99949601,-73.95299117,-73.95234386,-73.95779,-73.95881081,-73.944694,-73.9551508,-73.99480011999999,-74.01122331619263,-74.013012,-73.97703874,-73.955736,-73.95850939,-73.95600096,-73.98802084,-73.99383605,-73.98302136,-73.9396861,-73.97803415,-73.95649469999999,-73.969024,-74.00926027,-74.00167,-74.00483091,-73.97790999999999,-74.01129573583603,-73.99193043,-74.0094613,-74.011169,-73.97111473,-73.93333490000001,-73.99990419,-73.97637605667114,-73.97519523,-73.96579,-73.94977,-73.94073717000001,-74.00562789,-73.98888587951659,-73.98362492,-73.98128127,-73.9919254,-73.98329859,-73.95739,-73.96264403000001,-73.96590294000001,-73.960876,-73.99785768,-74.015756,-74.00670227000001,-74.01234218,-73.99851193000001,-74.00016545,-73.96316109999999,-73.98564945,-73.98713956,-73.953149,-73.95095259,-73.99147535,-73.98912867,-73.954131,-73.99906065,-73.94708417,-73.9671457,-73.99200509000001,-73.99490341544151,-73.9534573,-73.95411749,-74.01658354,-73.97041192,-73.9645,-73.96649479866028,-73.96621737780001,-73.9664492472,-73.9605909006,-73.9621128676,-73.96295000000001,-73.99994660999999,-74.00513872504234,-73.99931783,-74.001384973526,-74.00681753000001,-74.00413691997528,-73.99456404999999,-74.00367558002472,-74.007756,-73.99726235,-74.00004031,-74.00451887,-73.99529885,-73.99144871,-73.99723551,-74.00218427181244,-73.993915,-73.99160000000001,-73.99093085,-74.0021163,-73.99516761302948,-73.9979009,-73.98338988,-73.99138152,-74.00293877,-73.9900262,-73.99098506999999,-73.99379968643188,-73.99461843,-73.98316936000001,-73.98014437,-73.98291153,-73.98257732391357,-73.98859650999999,-73.99667444000001,-73.99301222,-73.98788205,-73.98917958140373,-73.99392888,-73.97648516,-73.97982001304626,-73.99061728,-73.98690506,-73.9783501625061,-73.98863900000001,-73.988038,-73.98261428000001,-73.98753759,-73.98266566,-73.97754961,-73.98093133,-73.97711200000001,-73.97283406,-73.9747,-73.97718340158461,-73.97041561,-73.9739,-73.97188800000001,-74.00165855884552,-73.96751037,-73.9737299,-74.00026394,-73.99404649,-74.00811899999999,-74.0127234,-74.00965965,-73.97945255041122,-73.974124,-74.01713445,-74.00887308,-73.94626915000001,-73.9813018,-73.99190759,-73.98955109000001,-73.98142006,-73.977706,-73.99415556,-73.99915362,-74.01322069],[4,0.5,4,2.598076211353316,2.598076211353316,1.414213562373095,0.5,1.414213562373095,5.590169943749475,1.414213562373095,0.5,2.598076211353316,0.5,0.5,2.598076211353316,0.5,1.414213562373095,1.414213562373095,0.5,0.5,0.5,0.5,0.5,0.5,2.598076211353316,0.5,0.5,0.5,1.414213562373095,0.5,0.5,0.5,0.5,2.598076211353316,0.5,0.5,0.5,0.5,1.414213562373095,0.5,1.414213562373095,1.414213562373095,1.414213562373095,7.348469228349535,0.5,7.348469228349535,7.348469228349535,4,1.414213562373095,2.598076211353316,7.348469228349535,0.5,1.414213562373095,1.414213562373095,0.5,5.590169943749475,2.598076211353316,0.5,1.414213562373095,0.5,0.5,1.414213562373095,0.5,4,0.5,1.414213562373095,0.5,0.5,4,1.414213562373095,0.5,0.5,0.5,0.5,2.598076211353316,0.5,1.414213562373095,0.5,4,0.5,0.5,7.348469228349535,1.414213562373095,4,2.598076211353316,2.598076211353316,4,2.598076211353316,5.590169943749475,1.414213562373095,5.590169943749475,0.5,7.348469228349535,0.5,1.414213562373095,0.5,1.414213562373095,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,5.590169943749475,0.5,0.5,0.5,1.414213562373095,1.414213562373095,2.598076211353316,1.414213562373095,5.590169943749475,1.414213562373095,0.5,1.414213562373095,1.414213562373095,0.5,0.5,0.5,2.598076211353316,0.5,0.5,1.414213562373095,0.5,5.590169943749475,0.5,0.5,1.414213562373095,2.598076211353316,0.5,0.5,0.5,0.5,0.5,0.5,1.414213562373095,0.5,1.414213562373095,1.414213562373095,1.414213562373095,1.414213562373095,0.5,1.414213562373095,0.5,1.414213562373095,5.590169943749475,2.598076211353316,1.414213562373095,0.5,0.5,0.5,2.598076211353316,0.5,1.414213562373095,0.5,2.598076211353316,1.414213562373095,2.598076211353316,2.598076211353316,0.5,0.5,0.5,1.414213562373095,4,4,0.5,5.590169943749475,4,7.348469228349535,1.414213562373095,1.414213562373095,2.598076211353316,0.5,4,2.598076211353316,0.5,2.598076211353316,1.414213562373095,2.598076211353316,0.5,0.5,2.598076211353316,0.5,0.5,1.414213562373095,2.598076211353316,5.590169943749475,0.5,5.590169943749475,0.5,1.414213562373095,0.5,2.598076211353316,0.5,2.598076211353316,0.5,1.414213562373095,0.5,1.414213562373095,0.5,0.5,1.414213562373095,4,2.598076211353316,1.414213562373095,0.5,4,1.414213562373095,0.5,1.414213562373095,0.5,0.5,1.414213562373095,0.5,0.5,0.5,4,1.414213562373095,2.598076211353316,0.5,0.5,0.5,0.5,1.414213562373095,1.414213562373095,0.5,0.5,0.5,0.5,1.414213562373095,0.5,0.5,5.590169943749475,0.5,0.5,0.5,1.414213562373095,0.5,2.598076211353316,0.5,0.5,4,1.414213562373095,0.5,1.414213562373095,1.414213562373095,0.5,4,5.590169943749475,0.5,1.414213562373095,4,2.598076211353316,4,1.414213562373095,0.5,0.5,0.5,1.414213562373095,2.598076211353316,1.414213562373095,2.598076211353316,1.414213562373095,1.414213562373095,0.5,0.5,1.414213562373095,4,1.414213562373095,2.598076211353316,0.5,2.598076211353316,4,4,2.598076211353316,0.5,0.5,0.5,1.414213562373095,0.5,0.5,0.5,2.598076211353316,1.414213562373095,1.414213562373095,0.5,0.5,2.598076211353316,0.5,7.348469228349535,2.598076211353316,0.5,0.5,0.5,1.414213562373095,0.5,0.5,0.5,1.414213562373095,0.5,2.598076211353316,0.5,4,0.5,1.414213562373095,0.5,4,0.5,0.5,0.5,0.5,4,0.5,2.598076211353316,0.5,0.5,0.5,1.414213562373095,1.414213562373095,0.5,1.414213562373095,2.598076211353316,0.5,5.590169943749475,4,1.414213562373095,0.5,0.5,1.414213562373095,0.5,0.5,0.5,0.5,1.414213562373095,0.5,1.414213562373095,0.5,4,0.5,0.5,0.5,1.414213562373095,0.5,1.414213562373095,1.414213562373095,0.5,0.5,2.598076211353316,2.598076211353316,1.414213562373095,0.5,1.414213562373095,1.414213562373095,1.414213562373095,4,0.5,0.5,0.5,0.5,0.5,4,0.5,0.5,5.590169943749475,5.590169943749475,0.5,1.414213562373095,4,1.414213562373095,1.414213562373095,0.5,0.5,0.5,0.5,0.5,0.5,2.598076211353316,1.414213562373095,5.590169943749475,4,2.598076211353316,2.598076211353316,2.598076211353316,4,2.598076211353316,5.590169943749475,1.414213562373095,5.590169943749475,7.348469228349535,1.414213562373095,2.598076211353316,2.598076211353316,5.590169943749475,4,2.598076211353316,1.414213562373095,0.5,7.348469228349535,1.414213562373095,2.598076211353316,2.598076211353316,7.348469228349535,1.414213562373095,4,5.590169943749475,1.414213562373095,0.5,1.414213562373095,0.5,2.598076211353316,2.598076211353316,2.598076211353316,2.598076211353316,0.5,0.5,2.598076211353316,5.590169943749475,0.5,2.598076211353316,1.414213562373095,0.5,5.590169943749475,4,1.414213562373095,0.5,2.598076211353316,1.414213562373095,0.5,1.414213562373095,0.5,0.5,2.598076211353316,1.414213562373095,2.598076211353316,1.414213562373095,1.414213562373095,0.5,0.5,5.590169943749475,1.414213562373095,0.5,0.5,2.598076211353316,0.5,0.5,1.414213562373095,0.5,0.5,9.260129588726068,15.8113883008419,9.260129588726068,13.5,9.260129588726068,9.260129588726068,9.260129588726068],null,null,{"interactive":true,"className":"","stroke":true,"color":["#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a"],"weight":1,"opacity":0.5,"fill":true,"fillColor":["#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a"],"fillOpacity":0.7},null,null,["1 Ave & E 16 St<br>Trips: 4","1 Ave & E 30 St<br>Trips: 1","1 Ave & E 44 St<br>Trips: 4","1 Ave & E 62 St<br>Trips: 3","1 Ave & E 68 St<br>Trips: 3","1 Ave & E 78 St<br>Trips: 2","10 St & 5 Ave<br>Trips: 1","10 St & 7 Ave<br>Trips: 2","11 Ave & W 27 St<br>Trips: 5","11 Ave & W 41 St<br>Trips: 2","11 Ave & W 59 St<br>Trips: 1","12 Ave & W 40 St<br>Trips: 3","14 St & 5 Ave<br>Trips: 1","2 Ave & E 104 St<br>Trips: 1","2 Ave & E 31 St<br>Trips: 3","2 Ave & E 96 St<br>Trips: 1","21 St & 31 Dr<br>Trips: 2","21 St & Queens Plaza North<br>Trips: 2","24 Ave & 26 St<br>Trips: 1","24 St & 41 Ave<br>Trips: 1","28 Ave & 44 St<br>Trips: 1","28 St & 40 Ave<br>Trips: 1","28 St & 41 Ave<br>Trips: 1","3 St & 3 Ave<br>Trips: 1","3 St & Prospect Park West<br>Trips: 3","31 Ave & Crescent St<br>Trips: 1","31 St & 23 Ave<br>Trips: 1","31 St & Broadway<br>Trips: 1","34 Ave & 38 St<br>Trips: 2","35 Ave & 10 St<br>Trips: 1","37 St & 24 Ave<br>Trips: 1","4 Ave & 9 St<br>Trips: 1","44 Dr & 21 St<br>Trips: 1","44 Dr & Jackson Ave<br>Trips: 3","46 Ave & 5 St<br>Trips: 1","5 Ave & 3 St<br>Trips: 1","5 Ave & E 63 St<br>Trips: 1","5 Ave & E 73 St<br>Trips: 1","5 Ave & E 78 St<br>Trips: 2","5 Ave & E 88 St<br>Trips: 1","5 Ave & E 93 St<br>Trips: 2","6 Ave & Canal St<br>Trips: 2","6 Ave & Spring St<br>Trips: 2","6 Ave & W 33 St<br>Trips: 6","7 St & 5 Ave<br>Trips: 1","8 Ave & W 31 St<br>Trips: 6","8 Ave & W 33 St<br>Trips: 6","8 Ave & W 52 St<br>Trips: 4","9 Ave & W 22 St<br>Trips: 2","9 Ave & W 28 St<br>Trips: 3","9 Ave & W 45 St<br>Trips: 6","Adelphi St & Myrtle Ave<br>Trips: 1","Allen St & Rivington St<br>Trips: 2","Allen St & Stanton St<br>Trips: 2","Amsterdam Ave & W 66 St<br>Trips: 1","Amsterdam Ave & W 73 St<br>Trips: 5","Amsterdam Ave & W 82 St<br>Trips: 3","Astoria Park S & Shore Blvd<br>Trips: 1","Atlantic Ave & Furman St<br>Trips: 2","Avenue D & E 12 St<br>Trips: 1","Avenue D & E 3 St<br>Trips: 1","Avenue D & E 8 St<br>Trips: 2","Baltic St & 5 Ave<br>Trips: 1","Bank St & Hudson St<br>Trips: 4","Bank St & Washington St<br>Trips: 1","Barrow St & Hudson St<br>Trips: 2","Bayard St & Baxter St<br>Trips: 1","Bedford Ave & Bergen St<br>Trips: 1","Bedford Ave & Nassau Ave<br>Trips: 4","Bergen St & Smith St<br>Trips: 2","Berkeley Pl & 6 Ave<br>Trips: 1","Berkeley Pl & 7 Ave<br>Trips: 1","Bialystoker Pl & Delancey St<br>Trips: 1","Boerum St & Broadway<br>Trips: 1","Bond St & Fulton St<br>Trips: 3","Broadway & 12 St<br>Trips: 1","Broadway & Battery Pl<br>Trips: 2","Broadway & Berry St<br>Trips: 1","Broadway & E 14 St<br>Trips: 4","Broadway & Moylan Pl<br>Trips: 1","Broadway & Roebling St<br>Trips: 1","Broadway & W 25 St<br>Trips: 6","Broadway & W 29 St<br>Trips: 2","Broadway & W 32 St<br>Trips: 4","Broadway & W 37 St<br>Trips: 3","Broadway & W 38 St<br>Trips: 3","Broadway & W 41 St<br>Trips: 4","Broadway & W 49 St<br>Trips: 3","Broadway & W 51 St<br>Trips: 5","Broadway & W 53 St<br>Trips: 2","Broadway & W 56 St<br>Trips: 5","Broadway & W 58 St<br>Trips: 1","Broadway & W 60 St<br>Trips: 6","Broadway & Whipple St<br>Trips: 1","Bus Slip & State St<br>Trips: 2","Bushwick Ave & Powers St<br>Trips: 1","Cadman Plaza E & Red Cross Pl<br>Trips: 2","Cadman Plaza West & Montague St<br>Trips: 1","Cambridge Pl & Gates Ave<br>Trips: 1","Canal St & Rutgers St<br>Trips: 1","Carlton Ave & Flushing Ave<br>Trips: 1","Carmine St & 6 Ave<br>Trips: 1","Carroll St & Columbia St<br>Trips: 1","Cathedral Pkwy & Broadway<br>Trips: 1","Catherine St & Monroe St<br>Trips: 1","Central Park North & Adam Clayton Powell Blvd<br>Trips: 1","Central Park S & 6 Ave<br>Trips: 5","Central Park W & W 96 St<br>Trips: 1","Central Park West & W 100 St<br>Trips: 1","Central Park West & W 68 St<br>Trips: 1","Central Park West & W 72 St<br>Trips: 2","Central Park West & W 76 St<br>Trips: 2","Centre St & Chambers St<br>Trips: 3","Centre St & Worth St<br>Trips: 2","Christopher St & Greenwich St<br>Trips: 5","Clark St & Henry St<br>Trips: 2","Clermont Ave & Lafayette Ave<br>Trips: 1","Clermont Ave & Park Ave<br>Trips: 2","Cleveland Pl & Spring St<br>Trips: 2","Cliff St & Fulton St<br>Trips: 1","Clinton Ave & Myrtle Ave<br>Trips: 1","Clinton St & Grand St<br>Trips: 1","Clinton St & Joralemon St<br>Trips: 3","Clinton St & Tillary St<br>Trips: 1","Columbia St & Degraw St<br>Trips: 1","Columbus Ave & W 72 St<br>Trips: 2","Columbus Ave & W 95 St<br>Trips: 1","Cooper Square & Astor Pl<br>Trips: 5","Court St & State St<br>Trips: 1","Crescent St & Broadway<br>Trips: 1","DeKalb Ave & Skillman St<br>Trips: 2","DeKalb Ave & Vanderbilt Ave<br>Trips: 3","Dean St & 4 Ave<br>Trips: 1","Dean St & Franklin Ave<br>Trips: 1","Degraw St & Hoyt St<br>Trips: 1","Degraw St & Smith St<br>Trips: 1","Devoe St & Lorimer St<br>Trips: 1","Ditmars Blvd & 19 St<br>Trips: 1","Division St & Bowery<br>Trips: 2","Douglass St & 3 Ave<br>Trips: 1","Douglass St & 4 Ave<br>Trips: 2","Driggs Ave & Lorimer St<br>Trips: 2","Duane St & Greenwich St<br>Trips: 2","E 10 St & 5 Ave<br>Trips: 2","E 102 St & 1 Ave<br>Trips: 1","E 102 St & Park Ave<br>Trips: 2","E 103 St & Lexington Ave<br>Trips: 1","E 11 St & 1 Ave<br>Trips: 2","E 11 St & 2 Ave<br>Trips: 5","E 11 St & Broadway<br>Trips: 3","E 110 St & Madison Ave<br>Trips: 2","E 115 St & Madison Ave<br>Trips: 1","E 116 St & 2 Ave<br>Trips: 1","E 118 St & Madison Ave<br>Trips: 1","E 12 St & 3 Ave<br>Trips: 3","E 123 St & Lexington Ave<br>Trips: 1","E 13 St & Avenue A<br>Trips: 2","E 13 St & Avenue A<br>Trips: 1","E 15 St & 3 Ave<br>Trips: 3","E 16 St & 5 Ave<br>Trips: 2","E 16 St & Irving Pl<br>Trips: 3","E 17 St & Broadway<br>Trips: 3","E 19 St & 3 Ave<br>Trips: 1","E 2 St & 2 Ave<br>Trips: 1","E 2 St & Avenue A<br>Trips: 1","E 2 St & Avenue B<br>Trips: 2","E 2 St & Avenue C<br>Trips: 4","E 20 St & 2 Ave<br>Trips: 4","E 20 St & FDR Drive<br>Trips: 1","E 20 St & Park Ave<br>Trips: 5","E 23 St & 1 Ave<br>Trips: 4","E 24 St & Park Ave S<br>Trips: 6","E 25 St & 1 Ave<br>Trips: 2","E 25 St & 2 Ave<br>Trips: 2","E 27 St & 1 Ave<br>Trips: 3","E 30 St & Park Ave S<br>Trips: 1","E 31 St & 3 Ave<br>Trips: 4","E 32 St & Park Ave<br>Trips: 3","E 33 St & 1 Ave<br>Trips: 1","E 33 St & 5 Ave<br>Trips: 3","E 35 St & 3 Ave<br>Trips: 2","E 39 St & 2 Ave<br>Trips: 3","E 39 St & 3 Ave<br>Trips: 1","E 41 St & 5 Ave<br>Trips: 1","E 41 St & Madison Ave<br>Trips: 3","E 43 St & 5 Ave<br>Trips: 1","E 44 St & 2 Ave<br>Trips: 1","E 45 St & 3 Ave<br>Trips: 2","E 47 St & 2 Ave<br>Trips: 3","E 47 St & Park Ave<br>Trips: 5","E 48 St & 3 Ave<br>Trips: 1","E 48 St & 5 Ave<br>Trips: 5","E 5 St & 2 Ave<br>Trips: 1","E 5 St & Avenue C<br>Trips: 2","E 51 St & Lexington Ave<br>Trips: 1","E 52 St & 2 Ave<br>Trips: 3","E 53 St & 3 Ave<br>Trips: 1","E 53 St & Madison Ave<br>Trips: 3","E 55 St & 2 Ave<br>Trips: 1","E 55 St & 3 Ave<br>Trips: 2","E 55 St & Lexington Ave<br>Trips: 1","E 58 St & 1 Ave<br>Trips: 2","E 58 St & 3 Ave<br>Trips: 1","E 58 St & Madison Ave<br>Trips: 1","E 59 St & Madison Ave<br>Trips: 2","E 6 St & Avenue B<br>Trips: 4","E 6 St & Avenue D<br>Trips: 3","E 60 St & York Ave<br>Trips: 2","E 65 St & 2 Ave<br>Trips: 1","E 7 St & Avenue A<br>Trips: 4","E 72 St & Park Ave<br>Trips: 2","E 72 St & York Ave<br>Trips: 1","E 74 St & 1 Ave<br>Trips: 2","E 75 St & 3 Ave<br>Trips: 1","E 76 St & 3 Ave<br>Trips: 1","E 78 St & 2 Ave<br>Trips: 2","E 81 St & 3 Ave<br>Trips: 1","E 81 St & Park Ave<br>Trips: 1","E 81 St & York Ave<br>Trips: 1","E 82 St & East End Ave<br>Trips: 4","E 84 St & 1 Ave<br>Trips: 2","E 85 St & 3 Ave<br>Trips: 3","E 85 St & York Ave<br>Trips: 1","E 88 St & 1 Ave<br>Trips: 1","E 89 St & York Ave<br>Trips: 1","E 9 St & Avenue C<br>Trips: 1","E 91 St & 2 Ave<br>Trips: 2","E 91 St & Park Ave<br>Trips: 2","E 93 St & 2 Ave<br>Trips: 1","E 95 St & 3 Ave<br>Trips: 1","E 97 St & Madison Ave<br>Trips: 1","East End Ave & E 86 St<br>Trips: 1","Eastern Pkwy & Franklin Ave<br>Trips: 2","FDR Drive & E 35 St<br>Trips: 1","Forsyth St & Broome St<br>Trips: 1","Forsyth St & Canal St<br>Trips: 5","Franklin St & W Broadway<br>Trips: 1","Frederick Douglass Blvd & W 112 St<br>Trips: 1","Frederick Douglass Blvd & W 117 St<br>Trips: 1","Front St & Maiden Ln<br>Trips: 2","Fulton St & Adams St<br>Trips: 1","Fulton St & Broadway<br>Trips: 3","Fulton St & Grand Ave<br>Trips: 1","Fulton St & Utica Ave<br>Trips: 1","Fulton St & William St<br>Trips: 4","Gansevoort St & Hudson St<br>Trips: 2","Graham Ave & Conselyea St<br>Trips: 1","Graham Ave & Grand St<br>Trips: 2","Graham Ave & Herbert St<br>Trips: 2","Graham Ave & Withers St<br>Trips: 1","Grand Army Plaza & Central Park S<br>Trips: 4","Grand St & Elizabeth St<br>Trips: 5","Grand St & Greene St<br>Trips: 1","Grand St & Havemeyer St<br>Trips: 2","Great Jones St<br>Trips: 4","Greenpoint Ave & Manhattan Ave<br>Trips: 3","Greenwich Ave & Charles St<br>Trips: 4","Greenwich St & W Houston St<br>Trips: 2","Hanson Pl & Ashland Pl<br>Trips: 1","Henry St & Atlantic Ave<br>Trips: 1","Henry St & Bay St<br>Trips: 1","Henry St & Degraw St<br>Trips: 2","Henry St & Grand St<br>Trips: 3","Hicks St & Montague St<br>Trips: 2","Hope St & Union Ave<br>Trips: 3","Howard St & Centre St<br>Trips: 2","Hoyt St & Warren St<br>Trips: 2","Hudson St & Reade St<br>Trips: 1","Jay St & York St<br>Trips: 1","John St & William St<br>Trips: 2","Kent Ave & N 7 St<br>Trips: 4","Kent Ave & S 11 St<br>Trips: 2","LaGuardia Pl & W 3 St<br>Trips: 3","Lafayette Ave & Fort Greene Pl<br>Trips: 1","Lafayette Ave & St James Pl<br>Trips: 3","Lafayette St & E 8 St<br>Trips: 4","Lafayette St & Jersey St<br>Trips: 4","Lenox Ave & W 111 St<br>Trips: 3","Lenox Ave & W 117 St<br>Trips: 1","Lenox Ave & W 130 St<br>Trips: 1","Leonard St & Boerum St<br>Trips: 1","Leonard St & Church St<br>Trips: 2","Leonard St & Maujer St<br>Trips: 1","Lewis Ave & Decatur St<br>Trips: 1","Lexington Ave & E 127 St<br>Trips: 1","Lexington Ave & E 24 St<br>Trips: 3","Lexington Ave & E 29 St<br>Trips: 2","Lexington Ave & E 63 St<br>Trips: 2","Liberty St & Broadway<br>Trips: 1","Lispenard St & Broadway<br>Trips: 1","Little West St & 1 Pl<br>Trips: 3","Lorimer St & Broadway<br>Trips: 1","MacDougal St & Prince St<br>Trips: 6","MacDougal St & Washington Sq<br>Trips: 3","Macon St & Nostrand Ave<br>Trips: 1","Madison Ave & E 82 St<br>Trips: 1","Madison Ave & E 99 St<br>Trips: 1","Madison St & Clinton St<br>Trips: 2","Marcy Ave & Lafayette Ave<br>Trips: 1","Market St & Cherry St<br>Trips: 1","McGuinness Blvd & Eagle St<br>Trips: 1","Mercer St & Bleecker St<br>Trips: 2","Mercer St & Spring St<br>Trips: 1","Meserole Ave & Manhattan Ave<br>Trips: 3","Metropolitan Ave & Meeker Ave<br>Trips: 1","Milton St & Franklin St<br>Trips: 4","Monroe St & Classon Ave<br>Trips: 1","Monroe St & Tompkins Ave<br>Trips: 2","Morningside Ave & W 123 St<br>Trips: 1","Mott St & Prince St<br>Trips: 4","Murray St & Greenwich St<br>Trips: 1","Murray St & West St<br>Trips: 1","Myrtle Ave & St Edwards St<br>Trips: 1","N 15 St & Wythe Ave<br>Trips: 1","N 6 St & Bedford Ave<br>Trips: 4","N 8 St & Driggs Ave<br>Trips: 1","Norfolk St & Broome St<br>Trips: 3","Old Fulton St<br>Trips: 1","Pacific St & Nevins St<br>Trips: 1","Park Ave & E 124 St<br>Trips: 1","Park Ave & St Edwards St<br>Trips: 2","Park Pl & Franklin Ave<br>Trips: 2","Park Pl & Vanderbilt Ave<br>Trips: 1","Pearl St & Hanover Square<br>Trips: 2","Peck Slip & Front St<br>Trips: 3","Perry St & Bleecker St<br>Trips: 1","Pershing Square South<br>Trips: 5","Pier 40 - Hudson River Park<br>Trips: 4","Pike St & Monroe St<br>Trips: 2","Pioneer St & Richards St<br>Trips: 1","Pioneer St & Van Brunt St<br>Trips: 1","Plaza St West & Flatbush Ave<br>Trips: 2","Pleasant Ave & E 116 St<br>Trips: 1","President St & Henry St<br>Trips: 1","Prospect Park West & 8 St<br>Trips: 1","Prospect Pl & 6 Ave<br>Trips: 1","Prospect Pl & Underhill Ave<br>Trips: 2","Putnam Ave & Nostrand Ave<br>Trips: 1","Queens Plaza North & Crescent St<br>Trips: 2","Reade St & Broadway<br>Trips: 1","Riverside Blvd & W 67 St<br>Trips: 4","Riverside Dr & W 78 St<br>Trips: 1","Riverside Dr & W 82 St<br>Trips: 1","Rivington St & Chrystie St<br>Trips: 1","Rivington St & Ridge St<br>Trips: 2","Roebling St & N 4 St<br>Trips: 1","S 3 St & Bedford Ave<br>Trips: 2","S 4 St & Wythe Ave<br>Trips: 2","S 5 Pl & S 5 St<br>Trips: 1","Smith St & 9 St<br>Trips: 1","South End Ave & Liberty St<br>Trips: 3","South St & Gouverneur Ln<br>Trips: 3","South St & Whitehall St<br>Trips: 2","St James Pl & Oliver St<br>Trips: 1","St James Pl & Pearl St<br>Trips: 2","St Johns Pl & Washington Ave<br>Trips: 2","St Marks Pl & 1 Ave<br>Trips: 2","St Marks Pl & 2 Ave<br>Trips: 4","St Nicholas Ave & Manhattan Ave<br>Trips: 1","Stagg St & Union Ave<br>Trips: 1","Stanton St & Chrystie St<br>Trips: 1","State St & Smith St<br>Trips: 1","Sterling Pl & Bedford Ave<br>Trips: 1","Sullivan St & Washington Sq<br>Trips: 4","Tompkins Ave & Hopkins St<br>Trips: 1","Underhill Ave & Lincoln Pl<br>Trips: 1","University Pl & E 14 St<br>Trips: 5","University Pl & E 8 St<br>Trips: 5","Vernon Blvd & 47 Rd<br>Trips: 1","Vernon Blvd & 50 Ave<br>Trips: 2","Vesey Pl & River Terrace<br>Trips: 4","W 100 St & Broadway<br>Trips: 2","W 100 St & Manhattan Ave<br>Trips: 2","W 104 St & Amsterdam Ave<br>Trips: 1","W 104 St & Amsterdam Ave - 1<br>Trips: 1","W 106 St & Amsterdam Ave<br>Trips: 1","W 106 St & Central Park West<br>Trips: 1","W 107 St & Columbus Ave<br>Trips: 1","W 110 St & Amsterdam Ave<br>Trips: 1","W 13 St & 7 Ave<br>Trips: 3","W 13 St & Hudson St<br>Trips: 2","W 15 St & 7 Ave<br>Trips: 5","W 16 St & 8 Ave<br>Trips: 4","W 16 St & The High Line<br>Trips: 3","W 17 St & 9 Ave<br>Trips: 3","W 18 St & 6 Ave<br>Trips: 3","W 18 St & 9 Ave<br>Trips: 4","W 20 St & 11 Ave<br>Trips: 3","W 20 St & 7 Ave<br>Trips: 5","W 20 St & 8 Ave<br>Trips: 2","W 22 St & 10 Ave<br>Trips: 5","W 24 St & 7 Ave<br>Trips: 6","W 25 St & 6 Ave<br>Trips: 2","W 26 St & 8 Ave<br>Trips: 3","W 27 St & 10 Ave<br>Trips: 3","W 27 St & 7 Ave<br>Trips: 5","W 31 St & 7 Ave<br>Trips: 4","W 33 St & 7 Ave<br>Trips: 3","W 34 St & 11 Ave<br>Trips: 2","W 36 St & 9 Ave<br>Trips: 1","W 37 St & 10 Ave<br>Trips: 6","W 37 St & 5 Ave<br>Trips: 2","W 38 St & 8 Ave<br>Trips: 3","W 4 St & 7 Ave S<br>Trips: 3","W 41 St & 8 Ave<br>Trips: 6","W 42 St & 8 Ave<br>Trips: 2","W 42 St & Dyer Ave<br>Trips: 4","W 43 St & 10 Ave<br>Trips: 5","W 43 St & 6 Ave<br>Trips: 2","W 44 St & 5 Ave<br>Trips: 1","W 45 St & 6 Ave<br>Trips: 2","W 45 St & 6 Ave (OLD)<br>Trips: 1","W 45 St & 8 Ave<br>Trips: 3","W 46 St & 11 Ave<br>Trips: 3","W 47 St & 10 Ave<br>Trips: 3","W 49 St & 8 Ave<br>Trips: 3","W 50 St & 9 Ave<br>Trips: 1","W 52 St & 11 Ave<br>Trips: 1","W 52 St & 5 Ave<br>Trips: 3","W 52 St & 6 Ave<br>Trips: 5","W 53 St & 10 Ave<br>Trips: 1","W 54 St & 9 Ave<br>Trips: 3","W 55 St & 6 Ave<br>Trips: 2","W 56 St & 10 Ave<br>Trips: 1","W 59 St & 10 Ave<br>Trips: 5","W 63 St & Broadway<br>Trips: 4","W 64 St & West End Ave<br>Trips: 2","W 67 St & Broadway<br>Trips: 1","W 74 St & Columbus Ave<br>Trips: 3","W 78 St & Broadway<br>Trips: 2","W 84 St & Broadway<br>Trips: 1","W 84 St & Columbus Ave<br>Trips: 2","W 87 St & Amsterdam Ave<br>Trips: 1","W 88 St & West End Ave<br>Trips: 1","W 89 St & Columbus Ave<br>Trips: 3","W 92 St & Broadway<br>Trips: 2","W 95 St & Broadway<br>Trips: 3","W Broadway & Spring Street<br>Trips: 2","Washington Ave & Park Ave<br>Trips: 2","Washington Park<br>Trips: 1","Washington Pl & 6 Ave<br>Trips: 1","Washington Pl & Broadway<br>Trips: 5","Washington St & Gansevoort St<br>Trips: 2","Water - Whitehall Plaza<br>Trips: 1","Watts St & Greenwich St<br>Trips: 1","West Drive & Prospect Park West<br>Trips: 3","West End Ave & W 94 St<br>Trips: 1","West Thames St<br>Trips: 1","William St & Pine St<br>Trips: 2","Willoughby Ave & Tompkins Ave<br>Trips: 1","Willoughby St & Fleet St<br>Trips: 1","Allen St & Hester St<br>Trips: 7","Broadway & E 22 St<br>Trips: 10","E 10 St & Avenue A<br>Trips: 7","Pershing Square North<br>Trips: 9","W 21 St & 6 Ave<br>Trips: 7","W 22 St & 8 Ave<br>Trips: 7","West St & Chambers St<br>Trips: 7"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#0a4c6a","#ca5800"],"labels":["Top 10","Other"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":"Start Station Volume","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.6610633719006,40.8143256],"lng":[-74.01713445,-73.91065120697021]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="popular-end-stations" class="level3">
<h3 class="anchored" data-anchor-id="popular-end-stations">Popular end stations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(end_station_name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(end_station_name, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  urbnthemes<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Most Popular Destination Stations"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Number of Trips"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ST557_Citi_Bikes_Sample_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="map-of-popular-start-and-end-stations" class="level3">
<h3 class="anchored" data-anchor-id="map-of-popular-start-and-end-stations">Map of popular start and end stations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>start_counts <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(start_station_name, start_station_latitude, start_station_longitude) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Top Start"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>end_counts <span class="ot">&lt;-</span> citibike_sample_2018 <span class="sc">|&gt;</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(end_station_name, end_station_latitude, end_station_longitude) <span class="sc">|&gt;</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_station_name =</span> end_station_name,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_station_latitude =</span> end_station_latitude,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">start_station_longitude =</span> end_station_longitude</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Top End"</span>)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>station_counts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(end_counts, start_counts) <span class="sc">|&gt;</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">if_else</span>(type <span class="sc">==</span> <span class="st">"Top Start"</span>, <span class="st">"#0a4c6a"</span>, <span class="st">"#ca5800"</span>)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(station_counts) <span class="sc">|&gt;</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>CartoDB.Positron) <span class="sc">|&gt;</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">lng =</span> <span class="sc">~</span>start_station_longitude,</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat =</span> <span class="sc">~</span>start_station_latitude,</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">radius =</span> <span class="sc">~</span><span class="fu">sqrt</span>(n) <span class="sc">*</span> <span class="fl">2.5</span>,</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">popup =</span> <span class="sc">~</span><span class="fu">paste0</span>(start_station_name, <span class="st">"&lt;br&gt;"</span>, type, <span class="st">"&lt;br&gt;Trips: "</span>, n),</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillOpacity =</span> <span class="fl">0.7</span>,</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="sc">~</span>color,</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">fillColor =</span> <span class="sc">~</span>color,</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">stroke =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight =</span> <span class="dv">1</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addLegend</span>(</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottomright"</span>,</span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">c</span>(<span class="st">"#0a4c6a"</span>, <span class="st">"#ca5800"</span>),</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Top 10 Start Stations"</span>, <span class="st">"Top 10 End Stations"</span>),</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Station Type"</span></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-b37ca67dc4349e04c5e0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b37ca67dc4349e04c5e0">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[40.75510267,40.74096374,40.722055,40.72210378668603,40.73221853,40.751873,40.74173969,40.74290902,40.77966809007312,40.73726186,40.73912601,40.73143724085228,40.74102150900266,40.746745,40.749156,40.7403432,40.751873,40.71605866,40.72740794,40.74173969,40.74475148,40.71754834,40.74901271,40.7505853470215,40.751551,40.76019252,40.74286877312112,40.76915505,40.74096374,40.72710258,40.74487634,40.75660359,40.75640548],[-73.97498696,-73.98602212999999,-73.98911099999999,-73.99724900722504,-73.98165557,-73.977706,-73.99415556,-73.97706058,-73.98093044757842,-73.99238966999999,-73.97973776000001,-73.99490341544151,-74.001384973526,-74.007756,-73.99160000000001,-73.98955109000001,-73.977706,-73.99190759,-73.98142006,-73.99415556,-73.99915362,-74.01322069,-73.98848395,-73.9946848154068,-73.993934,-73.9912551,-73.98918628692627,-73.98191841000001,-73.98602212999999,-74.00297088000001,-73.99529885,-73.9979009,-73.9900262],[8.291561975888499,7.905694150420949,7.5,7.5,7.071067811865476,7.071067811865476,7.071067811865476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,7.905694150420949,7.5,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.614378277661476,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945,6.123724356957945],null,null,{"interactive":true,"className":"","stroke":true,"color":["#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a"],"weight":1,"opacity":0.5,"fill":true,"fillColor":["#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#ca5800","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a","#0a4c6a"],"fillOpacity":0.7},null,null,["E 47 St & Park Ave<br>Top End<br>Trips: 11","E 24 St & Park Ave S<br>Top End<br>Trips: 10","Allen St & Stanton St<br>Top End<br>Trips: 9","Cleveland Pl & Spring St<br>Top End<br>Trips: 9","1 Ave & E 16 St<br>Top End<br>Trips: 8","Pershing Square North<br>Top End<br>Trips: 8","W 21 St & 6 Ave<br>Top End<br>Trips: 8","2 Ave & E 31 St<br>Top End<br>Trips: 7","Amsterdam Ave & W 73 St<br>Top End<br>Trips: 7","E 16 St & 5 Ave<br>Top End<br>Trips: 7","E 25 St & 2 Ave<br>Top End<br>Trips: 7","University Pl & E 8 St<br>Top End<br>Trips: 7","W 16 St & 8 Ave<br>Top End<br>Trips: 7","W 20 St & 11 Ave<br>Top End<br>Trips: 7","W 31 St & 7 Ave<br>Top End<br>Trips: 7","Broadway & E 22 St<br>Top Start<br>Trips: 10","Pershing Square North<br>Top Start<br>Trips: 9","Allen St & Hester St<br>Top Start<br>Trips: 7","E 10 St & Avenue A<br>Top Start<br>Trips: 7","W 21 St & 6 Ave<br>Top Start<br>Trips: 7","W 22 St & 8 Ave<br>Top Start<br>Trips: 7","West St & Chambers St<br>Top Start<br>Trips: 7","6 Ave & W 33 St<br>Top Start<br>Trips: 6","8 Ave & W 31 St<br>Top Start<br>Trips: 6","8 Ave & W 33 St<br>Top Start<br>Trips: 6","9 Ave & W 45 St<br>Top Start<br>Trips: 6","Broadway & W 25 St<br>Top Start<br>Trips: 6","Broadway & W 60 St<br>Top Start<br>Trips: 6","E 24 St & Park Ave S<br>Top Start<br>Trips: 6","MacDougal St & Prince St<br>Top Start<br>Trips: 6","W 24 St & 7 Ave<br>Top Start<br>Trips: 6","W 37 St & 10 Ave<br>Top Start<br>Trips: 6","W 41 St & 8 Ave<br>Top Start<br>Trips: 6"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#0a4c6a","#ca5800"],"labels":["Top 10 Start Stations","Top 10 End Stations"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"bottomright","type":"unknown","title":"Station Type","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[40.71605866,40.77966809007312],"lng":[-74.01322069,-73.97498696]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>